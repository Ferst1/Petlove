import{r as c,j as e,A as M,m as A,I as L,B as h,a as u,u as j,d as k,z as I,C as R,D as C,E as B,M as O,F as D}from"./index-ChFUDA8s.js";import{F as V,a as _,b as f}from"./formik.esm-yd7nTQh6.js";import{U as z}from"./UploadInput-9i2Tjoyu.js";import{P as T}from"./PetCard-GKbfQIKH.js";import"./hoist-non-react-statics.cjs-BJAZoXu8.js";const K="/Petlove/images/user-profile/user-profile.png",E="/Petlove/images/user-profile/user-upload.png",$="/Petlove/images/user-profile/edit.png",q=({isOpen:t,onClose:n,user:a,onSave:i})=>{const[l,d]=c.useState((a==null?void 0:a.avatar)||E),[o,s]=c.useState((a==null?void 0:a.name)||""),[x,b]=c.useState((a==null?void 0:a.email)||""),[g,P]=c.useState((a==null?void 0:a.phone)||""),N=c.useRef(null),y=r=>{r.key==="Escape"&&n()},S=r=>{r.target===r.currentTarget&&n()},w=r=>{const p=r.target.files[0];if(p){const m=new FileReader;m.onload=()=>{d(m.result)},m.readAsDataURL(p)}},U=()=>{N.current.click()},v=r=>{const{name:p,value:m}=r.target;p==="name"?s(m):p==="email"?b(m):p==="phone"&&P(m)},F=()=>{i({avatar:l,name:o,email:x,phone:g}),n()};return c.useLayoutEffect(()=>(t?(document.body.style.overflow="hidden",document.addEventListener("keydown",y)):document.body.style.overflow="unset",()=>{document.removeEventListener("keydown",y)}),[t]),e.jsx(M,{children:t&&e.jsx("div",{className:"backdrop",onClick:S,children:e.jsx(A.div,{"data-aos":"fade-up","data-aos-delay":"100",className:"modal-window",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("button",{className:"close-btn",onClick:n,children:e.jsx(L,{size:"24px"})}),e.jsx("h3",{children:"Edit information"}),e.jsx("img",{src:l,alt:`${o}'s avatar`,className:"user-avatar"}),e.jsxs("div",{className:"img-upload",children:[e.jsx(z,{handleFileChange:w,handleAvatarUpload:U}),e.jsx("input",{type:"file",name:"file",ref:N,onChange:w,className:"select-avatar-input",style:{display:"none"}})]}),e.jsx("input",{type:"text",name:"name",value:o,onChange:v,placeholder:"Name",className:"full-width-input"}),e.jsx("input",{type:"email",name:"email",value:x,onChange:v,placeholder:"E-mail",className:"full-width-input"}),e.jsx("input",{type:"tel",name:"phone",value:g,onChange:v,placeholder:"+380 ",className:"full-width-input"}),e.jsxs("div",{className:"buttons_modal",children:[e.jsx(h,{text:"Save",onClick:F}),e.jsx(h,{text:"Cancel",onClick:n})]})]})})})})},G=()=>{const t=u(s=>s.user.user),n=j(),a=k(),[i,l]=c.useState(!1),d=s=>{n(I({uid:t.uid,name:s.name,email:s.email,phone:s.phone})),s.avatar&&n(R({uid:t.uid,avatar:s.avatar}))},o=()=>{l(!0)};return e.jsxs("div",{className:"user-card",children:[e.jsxs("div",{className:"user-updated",children:[e.jsx("img",{className:"user-logo",src:K,alt:"User Logo"}),e.jsx("div",{className:"img-upload",children:e.jsx("img",{className:"user-upload",src:(t==null?void 0:t.avatar)||E,alt:"User Upload"})}),e.jsx("img",{className:"user-edit",src:$,alt:"User Edit",onClick:o})]}),t?e.jsx(V,{initialValues:{name:t.name,email:t.email,phone:t.phone},onSubmit:d,children:e.jsx(_,{children:e.jsxs("div",{className:"name-input-wrapper",children:[e.jsx(f,{type:"text",name:"name",className:"change-name-input"}),e.jsx(f,{type:"email",name:"email",className:"change-name-input"}),e.jsx(f,{type:"text",name:"phone",placeholder:"+380",className:"change-name-input"})]})})}):e.jsx("p",{children:"Loading..."}),e.jsxs("div",{className:"my-pets",children:[e.jsx("h3",{children:"My pets"}),e.jsx(h,{text:"Add pet +",className:"button-add",onClick:()=>a("/add_pet")})]}),e.jsx(q,{isOpen:i,onClose:()=>l(!1),user:t,onSave:d})]})},H=()=>{const t=j(),n=u(s=>s.favoritePets.pets),a=u(s=>s.viewedPets.viewedPets),i=u(s=>s.favoritePets.showFavorites);c.useEffect(()=>{console.log("Favorite Pets:",n),console.log("Viewed Pets:",a)},[n,a]);const l=()=>{t(C(!0))},d=()=>{t(C(!1))},o=i?n:a;return e.jsxs("div",{className:"my-notices",children:[e.jsxs("div",{className:"button-container",children:[e.jsx(h,{text:"My favorite pets",onClick:l,className:i?"active-button":"white-button"}),e.jsx(h,{text:"Viewed",onClick:d,className:i?"white-button":"active-button"})]}),!o||o.length===0?e.jsx("p",{children:`Oops, looks like there aren't any furries on our adorable page yet. Do not worry! View your pets on the "find your favorite pet" page and add them to your favorites.`}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"notices-grid",children:o.map(s=>e.jsx(T,{pet:s,showRemoveButton:i},s._id))})})]})},Z=()=>{const t=j(),n=k(),a=u(x=>x.user.user),[i,l]=c.useState(!1);c.useEffect(()=>{a||n("/login")},[a,n]);const d=()=>{t(D()),n("/login")},o=()=>{l(!0)},s=()=>{l(!1)};return e.jsxs("div",{className:"profile-page",children:[e.jsxs("div",{className:"user-card",children:[e.jsx(G,{}),e.jsx(B,{text:"Logout",to:"#",className:"logout-btn",onClick:o})]}),e.jsx(H,{}),e.jsx(O,{isOpen:i,onClose:s,onConfirm:d})]})};export{Z as default};
