import{u as S,a as v,j as e,r as X,b as Y,c as q,A as ee,d as se,e as te,s as A,f as F,g as I,h as $,i as E,k as ae,l as L,m as ne}from"./index-Du0h560d.js";import{r as f}from"./react-vendor-BZdliVqA.js";import{P as oe}from"./PetCard-DILbzn4u.js";import{I as M}from"./index-B9iVpkjT.js";import{A as T,m as B}from"./Modal-uCFdFS9f.js";import{B as N}from"./Button-Y4XlQeTO.js";import{S as G,R,T as le}from"./TypeSelect-DujzWzKx.js";import{I as z,P as ie}from"./Pagination-DVTHpiwf.js";import"./hoist-non-react-statics.cjs-2Q9SGLSQ.js";const w="/images/star.png",_="/images/star-transparent.png",ce="/images/heard-white.png",K=({children:h,isOpen:i,onClose:c,pet:n})=>{const s=S(),m=v(r=>r.favoritePets.pets),x=n?m.some(r=>r._id===n._id):!1,o={hidden:{opacity:0,scale:.8},visible:{opacity:1,scale:1,transition:{duration:.5,ease:"easeInOut"}},exit:{opacity:0,scale:.8,transition:{duration:.3,ease:"easeInOut"}}},l=r=>{r.key==="Escape"&&c()},a=r=>{r.target===r.currentTarget&&c()},t=()=>{s(x?X(n):Y(n))};return f.useLayoutEffect(()=>(document.addEventListener("keydown",l),()=>{document.removeEventListener("keydown",l)}),[]),f.useLayoutEffect(()=>{i?document.body.style.overflow="hidden":document.body.style.overflow="unset"},[i]),e.jsx(T,{children:i&&n&&e.jsx("div",{className:"backdrop",onClick:a,children:e.jsx(B.div,{className:"modal-window",initial:"hidden",animate:"visible",exit:"exit",variants:o,children:e.jsx("div",{className:"modal-content",children:e.jsxs("div",{className:"pet-info",children:[e.jsx("button",{className:"close-btn",onClick:c,children:e.jsx(M,{size:"24px"})}),e.jsx("img",{src:n.imgURL,alt:n.title}),e.jsx("p",{className:"category_modal",children:n.category}),e.jsx("h2",{children:n.title}),e.jsxs("div",{className:"name-rating",children:[e.jsx("img",{className:"star",src:w}),e.jsx("img",{className:"star",src:w}),e.jsx("img",{className:"star",src:w}),e.jsx("img",{className:"star",src:_}),e.jsx("img",{className:"star",src:_}),e.jsx("p",{children:n.popularity})]}),e.jsxs("div",{className:"info_item",children:[e.jsxs("p",{children:[e.jsx("div",{className:"label",children:"Name:"})," ",n.name]}),e.jsxs("p",{children:[e.jsx("div",{className:"label",children:"Birthday:"})," ",n.birthday]}),e.jsxs("p",{children:[e.jsx("div",{className:"label",children:"Sex:"})," ",n.sex]}),e.jsxs("p",{children:[e.jsx("div",{className:"label",children:"Species:"})," ",n.species]})]}),e.jsx("p",{className:"comment",children:n.comment}),e.jsxs("div",{className:"buttons_modal",children:[e.jsx(N,{text:x?"Remove from favorites":"Add to favorites",className:"primary",onClick:t,children:e.jsx("img",{src:ce,alt:"Heart",className:"button-icon"})}),e.jsx(N,{text:"Contact",className:"primary"})]})]})})})})})},re="/assets/avatar-dog-BZf1xWKu.png",O=({isOpen:h,onClose:i})=>{q();const c=s=>{s.key==="Escape"&&i()},n=s=>{s.target===s.currentTarget&&i()};return f.useLayoutEffect(()=>(document.addEventListener("keydown",c),()=>{document.removeEventListener("keydown",c)}),[]),f.useLayoutEffect(()=>{h?document.body.style.overflow="hidden":document.body.style.overflow="unset"},[h]),e.jsx(T,{children:h&&e.jsx("div",{className:"backdrop",onClick:n,children:e.jsx(B.div,{"data-aos":"fade-up","data-aos-delay":"100",className:"modal-window",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("button",{className:"close-btn",onClick:i,children:e.jsx(M,{size:"24px"})}),e.jsx("img",{src:re,alt:"avatar pet"}),e.jsx("h3",{children:"Attention"}),e.jsx("p",{children:"We would like to remind you that certain functionality is available only to authorized users. If you have an account, please log in with your credentials. If you do not already have an account, you must register to access these features."}),e.jsx("div",{className:"buttons_modal",children:e.jsx(ee,{})})]})})})})},de=({pets:h,loading:i})=>{const[c,n]=f.useState(null),[s,m]=f.useState(!1),x=S(),{user:o}=v(t=>t.user),l=t=>{o?(n(t),x(se(t))):m(!0)},a=()=>{n(null),m(!1)};return e.jsxs("div",{className:"find_pets_card_wrapper",children:[e.jsx("div",{className:"find_pets_card",children:i?e.jsx("p",{children:"Loading..."}):h.map(t=>e.jsx(oe,{pet:t,openModal:l},t._id))}),c&&e.jsxs(K,{isOpen:c!==null,onClose:a,pet:c,children:[e.jsx("h2",{children:c.title}),e.jsx("button",{onClick:a,children:"Close Modal"})]}),e.jsx(O,{isOpen:s,onClose:a})]})},he=["found","free","lost","sell"],ue=({onChange:h})=>{const[i,c]=f.useState(null),n=s=>{c(s),h(s?s.value:"")};return e.jsx(G,{value:i,onChange:n,options:he.map(s=>({value:s,label:s})),isSearchable:!0,placeholder:"Category",isClearable:!0,styles:R})},pe=["female","male","multiple","unknown"],me=({onChange:h})=>{const[i,c]=f.useState(null),n=s=>{c(s),h(s?s.value:"")};return e.jsx(G,{value:i,onChange:n,options:pe.map(s=>({value:s,label:s})),isSearchable:!0,placeholder:"By gender",isClearable:!0,styles:R})},xe=({onChange:h})=>{const[i,c]=f.useState([]),[n,s]=f.useState([]);f.useEffect(()=>{(async()=>{try{const t=(await te.get("/api/locations")).data.map(r=>({value:`${r.stateEn} ${r.cityEn} ${r.countyEn}`,label:`${r.stateEn}, ${r.cityEn} (${r.countyEn})`}));c(t),s(t)}catch(a){console.error("Error fetching locations:",a)}})()},[]);const m=l=>{const a=i.filter(t=>t.label.toLowerCase().includes(l.toLowerCase()));s(a),h(l)},x=()=>{s(i),h("")},o=l=>{s([]),h(l.value)};return e.jsxs("div",{children:[e.jsx(z,{onSearch:m,onClear:x}),n.length>0&&e.jsx("ul",{className:"dropdown-menu",children:n.map((l,a)=>e.jsx("li",{onClick:()=>o(l),className:"dropdown-item",children:l.label},a))})]})},fe=({categories:h,genders:i,types:c,locations:n,onSearch:s,onClear:m,onCategoryChange:x,onGenderChange:o,onTypeChange:l,onLocationChange:a})=>{const[t,r]=f.useState(""),u=S(),g=p=>{u(A(p)),x(p)},C=p=>{u(F(p)),o(p)},y=p=>{u(I(p)),l(p)},b=p=>{u($(p)),a(p)},j=p=>{t===p?(r(""),u(E(""))):(r(p),u(E(p)))};return e.jsxs("div",{className:"search_wrapper",children:[e.jsx(z,{onSearch:s,onClear:m}),e.jsxs("div",{className:"search_field_form",children:[e.jsx(ue,{onChange:g,categories:h}),e.jsx(me,{onChange:C,genders:i}),e.jsx(le,{placeholder:"Type of",onChange:y,types:c}),e.jsx(xe,{onChange:b,locations:n})]}),e.jsxs("div",{className:"radio_button",children:[e.jsx(N,{text:"Popular",color:"white",isActive:t==="popularity",onClick:()=>j("popularity"),isClearable:t==="popularity",onClear:()=>j("popularity")}),e.jsx(N,{text:"Unpopular",color:"white",isActive:t==="unpopularity",onClick:()=>j("unpopularity"),isClearable:t==="unpopularity",onClear:()=>j("unpopularity")}),e.jsx(N,{text:"Cheap",color:"white",isActive:t==="cheap",onClick:()=>j("cheap"),isClearable:t==="cheap",onClear:()=>j("cheap")}),e.jsx(N,{text:"Expensive",color:"white",isActive:t==="expensive",onClick:()=>j("expensive"),isClearable:t==="expensive",onClear:()=>j("expensive")})]})]})},ye=(h,i,c,n,s,m,x)=>{let o=h;const l=i.toLowerCase();return i&&(o=o.filter(a=>{const{species:t,title:r,name:u,comment:g,sex:C,location:y}=a,b=`${(y==null?void 0:y.stateEn)||""} ${(y==null?void 0:y.cityEn)||""}`.toLowerCase();return t&&t.toLowerCase().includes(l)||r&&r.toLowerCase().includes(l)||u&&u.toLowerCase().includes(l)||g&&g.toLowerCase().includes(l)||C&&C.toLowerCase().includes(l)||b.includes(l)})),c&&(o=o.filter(a=>a.category===c)),n&&(o=o.filter(a=>a.sex===n)),s&&(o=o.filter(a=>a.species===s)),m&&(o=o.filter(a=>`${a.location.stateEn} ${a.location.cityEn}`.toLowerCase().includes(m.toLowerCase()))),x==="popularity"?o=o.slice().sort((a,t)=>t.popularity-a.popularity):x==="unpopularity"?o=o.slice().sort((a,t)=>a.popularity-t.popularity):x==="cheap"?o=o.slice().sort((a,t)=>a.price-t.price):x==="expensive"&&(o=o.slice().sort((a,t)=>t.price-a.price)),o},je=["found","free","lost","sell"],ge=["female","male","multiple","unknown"],Ce=["dog","cat","monkey","bird","snake","turtle","lizard","frog","fish","ants","bees","butterfly","spider","scorpion"],_e=()=>{const{locations:h}=v(d=>d.data),{pets:i,totalItems:c,loading:n,query:s,currentPage:m}=v(d=>d.search),{category:x,gender:o,type:l,location:a}=v(d=>d.filters),{sortBy:t}=v(d=>d.sort),{user:r}=v(d=>d.user),u=S(),g=6,[C,y]=f.useState(!1),[b,j]=f.useState(null);f.useEffect(()=>{u(ae({query:s}))},[u,s]);const p=d=>{u(L(d))},Q=()=>{u(L(""))},H=d=>{u(ne(d))},U=d=>{u(A(d))},V=d=>{u(F(d))},W=d=>{u(I(d))},D=d=>{u($(d))},Z=d=>{j(d),y(!0)},k=()=>{y(!1),j(null)},P=ye(i,s,x,o,l,a,t),J=P.slice((m-1)*g,m*g);return e.jsxs("div",{className:"container",children:[e.jsxs("section",{className:"find_yor_pets",children:[e.jsx("h2",{children:"Find your favorite pet"}),e.jsx("div",{className:"find_pets_container",children:e.jsx(fe,{categories:je,genders:ge,types:Ce,locations:h,onSearch:p,onClear:Q,onCategoryChange:U,onGenderChange:V,onTypeChange:W,onLocationChange:D})}),e.jsx("div",{className:"pets_section",children:e.jsx(de,{pets:J,loading:n,onPetClick:Z})}),e.jsx(ie,{totalItems:P.length,itemsPerPage:g,onPageChange:H,currentPage:m})]}),r?e.jsx(K,{isOpen:C,onClose:k,pet:b}):e.jsx(O,{isOpen:C,onClose:k})]})};export{_e as default};
